name: 1.0.$(Rev:r)

trigger:
  - master

pool:
  vmImage: ubuntu-latest

steps:
  - task: DotNetCoreCLI@2
    inputs:
      command: build

  - task: DotNetCoreCLI@2
    inputs:
      command: pack
      packagesToPack: '**/*.fsproj'
      versioningScheme: byBuildNumber

  - task: DotNetCoreCLI@2
    inputs:
      command: push
      packagesToPush: '$(Build.ArtifactStagingDirectory)/*.nupkg'
      nuGetFeedType: external
      publishFeedCredentials: NuGet Pulumi.FSharp.Azure